<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>TaskFlow - Tareas Pendientes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
</head>
<body>
    <div class="container">
        <h1>ğŸ“‹ TaskFlow</h1>

        <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">
            <a href="{{ url_for('crear_tarea_web') }}" class="add-link" style="margin: 0; flex: 1;">â• Nueva Tarea</a>
            <a href="{{ url_for('crear_proyecto_web') }}" class="add-link" style="background-color: #6c757d; margin: 0; flex: 1;">ğŸ“ Nuevo Proyecto</a>
          
        </div>

        <h2>ğŸ“‚ Proyectos y Tareas</h2>
        
        {% for proyecto in proyectos %}
        <div class="project-group" style="margin-bottom: 30px; border: 1px solid #eee; border-radius: 8px; padding: 15px;">
            <h3 style="color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px;">
                {{ proyecto._nombre }} 
                <span style="font-size: 0.6em; color: #666; float: right;">Estado: {{ proyecto._estado }}</span>
            </h3>

            <ul class="task-list">
                {% set tiene_tareas = false %}
                {% for tarea in tareas %}
                    {% if tarea._proyecto_id == proyecto._id %}
                        {% set tiene_tareas = true %}
                        <li class="task-item">
                            <div class="task-info">
                                <div class="task-title">
                                    {{ tarea._titulo }} 
                                    <span class="priority-{{ tarea._prioridad.lower() }}">
                                        ({{ tarea._prioridad }})
                                    </span>
                                </div>
                                <small>LÃ­mite: {{ tarea._fecha_limite }}</small>
                            </div>

                            <div class="task-actions">
                                <a href="{{ url_for('completar_tarea', tarea_id=tarea._id) }}" class="action-button">Completar</a>
                                <a href="{{ url_for('editar_tarea_web', tarea_id=tarea._id) }}" class="action-button" style="background-color: #ffc107; margin: 0; flex: 1;">âœï¸ Editar Tarea</a>
                                <a href="{{ url_for('eliminar_tarea', tarea_id=tarea._id) }}" 
                                   class="action-button" 
                                   style="background-color: #dc3545;" 
                                   onclick="return confirm('Â¿Seguro que deseas eliminar esta tarea?')">
                                   Eliminar
                                </a>
                            </div>
                        </li>
                    {% endif %}
                {% endfor %}

                {% if not tiene_tareas %}
                    <li class="task-item" style="color: #999; font-style: italic;">
                        No hay tareas pendientes en este proyecto.
                    </li>
                {% endif %}
            </ul>
        </div>
        {% else %}
            <p>No hay proyectos creados. Â¡Empieza creando uno!</p>
        {% endfor %}
    </div>
</body>
</html>